# 1、SSL/TLS 配置与分析

## 1.1 实验目的 ##
通过实验，掌握SSL的基本原理，掌握基本工具wireshark的使用。利用wireshark抓包并分析捕获的数据包，比较SSL使用前后的变化。

## 1.2 实验原理与理论基础 ##
SSL（Secure Socket Layer）是一个安全协议，它提供使用 TCP/IP 的通信应用程序间的隐私与完整性。它在传输层对网络连接进行加密。 SSL协议通过认证用户和服务器，确保数据发送到正确的客户机和服务器。加密数据以防止数据中途被窃取。维护数据的完整性，确保数据在传输过程中不被改变。

SSL工作原理：

(1)客户端向服务器端发起 SSL 连接请求；

(2)服务器把公钥发送给客户端，并且服务器端保存着唯一的私钥；

(3)客户端用公钥对双方通信的对称秘钥进行加密，并发送给服务器端；

(4)服务器利用自己唯一的私钥对客户端发来的对称秘钥进行解密；

(5)进行数据传输，服务器和客户端双方用公有的相同的对称秘钥对数据进行加密解密，可以保证在数据收发过程中的安全，即是第三方获得数据包，也无法对其进行加密，解密和篡改。


## 1.3 实验步骤 ##


### 1.3.1 搭建http网站 ###

#### 在WindowsServer2016中启用iis管理器 ####

![](.\\pics\\1.png)

#### 编辑网站 ####

![](.\\pics\\2.png)

![](.\\pics\\3.png)

#### 在网站中添加默认文档

![](.\\pics\\5.png)

#### 配置DNS服务器，使主机名www.4782.com指向ip地址192.168.0.193

![](.\\pics\\4.png)

#### 在客户端中把DNS服务器地址改为192.168.0.193（网站和DNS在同一个服务器上）

![](.\\pics\\6.png)

#### 在win10客户端访问网站

![](.\\pics\\7.png)

### 1.3.3抓包分析 ###

#### 使用wireshark抓包，可以看到http包中的内容是没有经过加密的，http协议是明文传输 ####

![](.\\pics\\8.png)

### 1.3.4配置SSL ###

#### 安装证书服务

![](.\\pics\\9.png)

#### 配置AD服务

![](.\\pics\\10.png)

#### 在iis中申请证书

![](.\\pics\\11.png)
![](.\\pics\\12.png)
![](.\\pics\\13.png)


#### 在web服务器中申请证书

![](.\\pics\\14.png)
![](.\\pics\\15.png)
![](.\\pics\\16.png)
![](.\\pics\\17.png)


#### CA颁发证书

![](.\\pics\\18.png)
![](.\\pics\\19.png)
![](.\\pics\\20.png)
![](.\\pics\\21.png)

#### 配置HTTPS和SSL

![](.\\pics\\22.png)
![](.\\pics\\23.png)

#### 访问网站

![](.\\pics\\24.png)
因为证书颁发机构（服务器端CA）不受win10客户端认可，所以提示不安全

![](.\\pics\\25.png)

#### 使用wireshark抓包


![](.\\pics\\26.png)
抓包结果显示网站使用了HTTPS协议，客户端与服务器进行SSL握手后传输已经加密的数据。